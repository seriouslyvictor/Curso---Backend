{% extends "blog/base.html" %}

{% block titulo %}
{% if termo_busca %}
    Busca: {{ termo_busca }} ‚Äî BlogPy
{% else %}
    Buscar ‚Äî BlogPy
{% endif %}
{% endblock %}

{% block conteudo %}
{% if termo_busca %}
    <h1>üîç Resultados para "{{ termo_busca }}"</h1>
    <p style="margin-bottom: 15px;">
        <a href="/">&larr; Todos os posts</a>
        &nbsp;|&nbsp;
        {{ paginacao.total }} resultado{{ "s" if paginacao.total != 1 }}
    </p>
{% else %}
    <h1>üîç Buscar Posts</h1>
{% endif %}

{% if posts %}
    {% for post in posts %}
    <div class="post-card">
        <h2><a href="/post/{{ post.id }}">{{ post.titulo }}</a></h2>
        <div class="post-meta">
            üìÖ {{ post.criado_em.strftime("%d/%m/%Y √†s %H:%M") }}
            {% if post.categoria %}
                &nbsp;|&nbsp;
                <a href="/categoria/{{ post.categoria.id }}" class="tag-categoria">
                    {{ post.categoria.nome }}
                </a>
            {% endif %}
        </div>
        <div class="post-resumo">
            {{ post.conteudo[:200] }}{% if post.conteudo|length > 200 %}...{% endif %}
        </div>
        <a href="/post/{{ post.id }}" class="btn btn-azul btn-sm">Ler mais</a>
    </div>
    {% endfor %}

    <!-- Pagina√ß√£o -->
    {% if paginacao.pages > 1 %}
    <div class="paginacao">
        {% if paginacao.has_prev %}
        <a href="?q={{ termo_busca }}&page={{ paginacao.prev_num }}">&larr; Anterior</a>
        {% endif %}

        {% for num in range(1, paginacao.pages + 1) %}
            {% if num == paginacao.page %}
                <span class="atual">{{ num }}</span>
            {% else %}
                <a href="?q={{ termo_busca }}&page={{ num }}">{{ num }}</a>
            {% endif %}
        {% endfor %}

        {% if paginacao.has_next %}
        <a href="?q={{ termo_busca }}&page={{ paginacao.next_num }}">Pr√≥xima &rarr;</a>
        {% endif %}
    </div>
    {% endif %}

{% else %}
<div class="card" style="text-align: center; padding: 50px;">
    <p style="font-size: 48px;">üîç</p>
    {% if termo_busca %}
        <p style="color: #999; margin-top: 10px;">
            Nenhum post encontrado para "<strong>{{ termo_busca }}</strong>".
        </p>
        <p style="margin-top: 10px;">
            <a href="/">Ver todos os posts</a>
        </p>
    {% else %}
        <p style="color: #999; margin-top: 10px;">
            Use a barra de busca para encontrar posts.
        </p>
    {% endif %}
</div>
{% endif %}
{% endblock %}
